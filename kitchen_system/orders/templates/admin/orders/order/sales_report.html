{% extends "admin/base_site.html" %}
{% load static %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
{% endblock %}

{% block content %}
<h1>Sales Report</h1>
<p><strong>Total Sales:</strong> KES {{ total_sales }}</p>

<table id="salesTable" class="display">
    <thead>
        <tr>
            <th>Customer</th>
            <th>Item</th>
            <th>Quantity</th>
            <th>Amount</th>
            <th>Payment Status</th>
            <th>Order Time</th>
        </tr>
    </thead>
    <tbody>
        {% for order in orders %}
        <tr>
            <td><a href="/admin/orders/order/{{ order.id }}/change/">{{ order.customer_name }}</a></td>
            <td>{{ order.item }}</td>
            <td>{{ order.quantity }}</td>
            <td>KES {{ order.computed_amount }}</td>
            <td>{{ order.payment_status }}</td>
            <td>{{ order.order_time }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">No orders available.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
    $(document).ready(function () {
        $('#salesTable').DataTable({
            "order": [[5, "desc"]],  // Default sort by latest order time
            "pageLength": 25
        });
    });
</script>
{% endblock %}